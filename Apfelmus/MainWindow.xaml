<Window x:Class="Apfelmus.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:conv="clr-namespace:ApfelmusFramework.Classes.Converter;assembly=ApfelmusFramework"
        xmlns:local="clr-namespace:ApfelmusFramework.Classes.Modified;assembly=ApfelmusFramework"
        xmlns:src="clr-namespace:ApfelmusFramework.Classes.Share;assembly=ApfelmusFramework"
        xmlns:help="clr-namespace:ApfelmusFramework.Classes.Help;assembly=ApfelmusFramework"
        xmlns:props="clr-namespace:Apfelmus.Properties"
        Title="Apfelmus" Loaded="Window_Loaded" Width="{Binding Source={x:Static props:Settings.Default}, Path=WindowWidth}" Height="{Binding Source={x:Static props:Settings.Default}, Path=WindowHeight}" Left="{Binding Source={x:Static props:Settings.Default}, Path=WindowLeft}" Top="{Binding Source={x:Static props:Settings.Default}, Path=WindowTop}" WindowState="{Binding Source={x:Static props:Settings.Default}, Path=WindowState}" Background="White" Icon="/ApfelmusFramework;component/Images/Apple-icon.png" Closing="Window_Closing" SizeChanged="MainWindow_SizeChanged" LocationChanged="MainWindow_LocationChanged" StateChanged="MainWindow_StateChanged">
    <Window.Resources>
        <ResourceDictionary Source="/Resourcen/ProgressBarWithText.xaml" />
    </Window.Resources>
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="25"/>
            <RowDefinition Height="25"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="25"/>
        </Grid.RowDefinitions>
        <Menu Grid.Row="0">
            <MenuItem Name="mItemExtras" Header="{DynamicResource extras}">
                <MenuItem Header="{DynamicResource settings}" Click="MenuItem_Click">
                    <MenuItem.Icon>
                        <Image Source="/ApfelmusFramework;component/Images/system_preferences.png" />
                    </MenuItem.Icon>
                </MenuItem>
            </MenuItem>
            <MenuItem Name="mItemLanguage" Header="{DynamicResource language}">
                <MenuItem Header="{DynamicResource german}" Click="German_Click">
                    <MenuItem.Icon>
                        <Image Source="/ApfelmusFramework;component/Images/germany.png" Width="18" Height="18" />
                    </MenuItem.Icon>
                </MenuItem>
                <MenuItem Header="{DynamicResource english}" Click="English_Click">
                    <MenuItem.Icon>
                        <Image Source="/ApfelmusFramework;component/Images/uk.png" Width="18" Height="18" />
                    </MenuItem.Icon>
                </MenuItem>
                <MenuItem Header="{DynamicResource italian}" Click="Italian_Click">
                    <MenuItem.Icon>
                        <Image Source="/ApfelmusFramework;component/Images/italy.png" Width="18" Height="18" />
                    </MenuItem.Icon>
                </MenuItem>
            </MenuItem>
            <MenuItem Name="mItemCore" Header="{DynamicResource core}">
                <MenuItem Header="{DynamicResource coreending}" Click="CoreExit_Click">
                    <MenuItem.Icon>
                        <Image Source="/ApfelmusFramework;component/Images/gnome_logout.png" Width="18" Height="18" />
                    </MenuItem.Icon>
                </MenuItem>
            </MenuItem>
        </Menu>
        <StackPanel Grid.Row="1" Orientation="Horizontal" Height="25" Background="White">
            <Label Content="AJLink:" Margin="5,0"/>
            <TextBox Name="tbxDownload" MinWidth="800" Width="Auto"/>
            <Button Name="btnDownload" Content="{DynamicResource transfer}" Width="100" Margin="5,0" Click="btnDownload_Click" HorizontalAlignment="Right" />
        </StackPanel>
        <TabControl Grid.Row="2" Name="tabControl" Background="White" Margin="0,5,0,0">
            <TabItem Name="tabStart">
                <TabItem.Header>
                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" VerticalAlignment="Center">
                        <Image Source="/ApfelmusFramework;component/Images/home.png" Width="18" Height="18" />
                        <TextBlock Text="{DynamicResource home}" Height="18" Margin="2,2,0,0" />
                    </StackPanel>
                </TabItem.Header>
                <DockPanel LastChildFill="False">
                    <StackPanel DockPanel.Dock="left" Orientation="Horizontal">
                        <DockPanel LastChildFill="False">
                            <GroupBox DockPanel.Dock="Top" Name="gbxClient" Header="{DynamicResource client}"  Width="240" Height="80" Margin="20" Padding="2">
                                <DockPanel LastChildFill="False">
                                    <StackPanel DockPanel.Dock="left" Orientation="Vertical" >
                                        <Label Content="{DynamicResource gui}" />
                                        <Label Content="{DynamicResource _core}" />
                                    </StackPanel>
                                    <StackPanel DockPanel.Dock="right" Orientation="Vertical">
                                        <Label Name="lblGui"  Content="{Binding Path=Release}" Foreground="Red" />
                                        <Label Name="lblCore" Content="{Binding Path=Version}" Foreground="Red" />
                                    </StackPanel>
                                </DockPanel>
                            </GroupBox>
                            <GroupBox DockPanel.Dock="Top" Name="gbxNetwork" Header="{DynamicResource network}" Width="240" Height="220" Margin="20 0 20 0">
                                <DockPanel LastChildFill="False">
                                    <DockPanel.Resources>
                                        <conv:FileSizeConverter2 x:Key="FileSizeConverter2" />
                                        <conv:FirewallConverter x:Key="FirewallConverter" />
                                    </DockPanel.Resources>
                                    <StackPanel DockPanel.Dock="left" Orientation="Vertical" >
                                        <Label Content="{DynamicResource user}" />
                                        <Label Content="{DynamicResource data}" />
                                        <Label Content="{DynamicResource totalsize}" />
                                        <Label Content="{DynamicResource connections_home}" />
                                        <Label Content="{DynamicResource uploadqueue}" />
                                        <Label Content="{DynamicResource firewall}" />
                                        <Label Content="{DynamicResource ip}" />
                                    </StackPanel>
                                    <StackPanel DockPanel.Dock="right" Orientation="Vertical">
                                        <Label Name="lblUsers" Content="{Binding Path=Users}" Foreground="Red" />
                                        <Label Name="lblFiles" Content="{Binding Path=Files}" Foreground="Red" />
                                        <Label Name="lblFileSize" Content="{Binding Path=FileSize, Converter={StaticResource FileSizeConverter2}}" Foreground="Red" />
                                        <Label Name="lblOpenConnections" Content="{Binding Path=OpenConnections}" Foreground="Red" />
                                        <Label Name="lblUploadQueue" Content="{Binding Path=MaxUploadPositions}" Foreground="Red" />
                                        <Image Name="imgFirewall" Source="{Binding Path=Firewalled, Converter={StaticResource FirewallConverter}}"  Width="16" Height="16" HorizontalAlignment="left" Margin="5,5,0,0"/>
                                        <Label Name="lblIp" Content="{Binding Path=Ip}" Foreground="Red" Margin="0,5,0,0" />
                                    </StackPanel>
                                </DockPanel>
                            </GroupBox>
                        </DockPanel>
                    </StackPanel>
                    <StackPanel DockPanel.Dock="Left">
                        <GroupBox DockPanel.Dock="Top" Name="gbxServer" Header="{DynamicResource server}"  Width="400" Height="auto" Margin="20" Padding="2">
                            <DockPanel LastChildFill="False">
                                <DockPanel.Resources>
                                    <conv:DeleteHtmlSpecialchars x:Key="DeleteHtmlSpecialchars" />
                                    <conv:SecondsToDate x:Key="SecondsToDate" />
                                </DockPanel.Resources>
                                <StackPanel DockPanel.Dock="Top">
                                    <DockPanel>
                                        <StackPanel DockPanel.Dock="left" Orientation="Vertical" >
                                            <Label Content="{DynamicResource servername_home}" />
                                            <Label Content="{DynamicResource connectedsince}" />
                                            <Label Content="{DynamicResource message}" />
                                        </StackPanel>
                                        <StackPanel DockPanel.Dock="Bottom"></StackPanel>
                                        <StackPanel DockPanel.Dock="right" Orientation="Vertical">
                                            <Label Name="lblServerName"  Content="{Binding Path=Name}" Foreground="Red" />
                                            <Label Name="lblConnectedSince" Content="{Binding Path=ConnectedSince, Converter={StaticResource SecondsToDate}}" Foreground="Red" />
                                        </StackPanel>
                                    </DockPanel>
                                </StackPanel>
                                <StackPanel Width="385" Height="auto" Orientation="Vertical">
                                    <TextBlock Name="txtBlockServerMessage" Width="375" Height="auto" Text="{Binding Path=WelcomeMessage, Converter={StaticResource DeleteHtmlSpecialchars}}" Foreground="Red" TextWrapping="Wrap" />
                                </StackPanel>
                            </DockPanel>
                        </GroupBox>
                    </StackPanel>
                </DockPanel>
            </TabItem>
            <TabItem  Name="tabShare">
                <TabItem.Header>
                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" VerticalAlignment="Center">
                        <Image Source="/ApfelmusFramework;component/Images/documents.png" Width="18" Height="18" />
                        <TextBlock Text="{DynamicResource share}" Height="18" Margin="2,2,0,0" />
                    </StackPanel>
                </TabItem.Header>
                <Grid Name="gridShare">
                    <Grid.Resources>
                        <conv:FileSizeConverter1 x:Key="FileSizeConverter1" />
                        <conv:SecondsToDate x:Key="SecondsToDate" />
                        <conv:SetClip x:Key="SetClip" />

                    </Grid.Resources>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="200" />
                        <ColumnDefinition Width="*" />
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="30" />
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="200" />
                    </Grid.RowDefinitions>
                    <StackPanel Grid.Row="0" Grid.Column="0" Grid.ColumnSpan="2" Orientation="Horizontal" HorizontalAlignment="Center" VerticalAlignment="Center">
                        <Button Name="btnShareRefresh" Content="{DynamicResource shareview}" Click="btnShareRefresh_Click" />
                        <ComboBox Name="cbxPriority" Margin="20,0,0,0" Width="50" ItemsSource="{Binding Path=Priority}" DisplayMemberPath="Value" SelectedValuePath="Key" SelectedValue="1"/>
                        <Button Name="btnSetPriority" Content="{DynamicResource setpriority}" Margin="20,0,0,0" Click="btnSetPriority_Click" />
                        <Button Name="btnDelPriority" Content="{DynamicResource delpriority}" Margin="20,0,0,0" Click="btnDelPriority_Click" />
                        <Button Name="btnShareCheck" Content="{DynamicResource sharecheck}" Margin="20,0,0,0" Click="btnShareCheck_Click" />
                    </StackPanel>
                    <Label Content="Verzeichnisse" Grid.Column="0" Grid.Row="1" Height="20" VerticalAlignment="Top" Margin="2" />
                    <TreeView Name="tViewSharePaths"  Grid.Column="0" Grid.Row="1" Grid.RowSpan="2">
                        <TreeView.Resources>
                            <conv:TypeToImage x:Key="TypeToImage" />
                            <HierarchicalDataTemplate DataType="{x:Type help:DirectoryChildren}" ItemsSource="{Binding Path=Childrens}">
                                <StackPanel Orientation="Horizontal">
                                    <Image Source="{Binding Path=Dir.Type,Converter={StaticResource TypeToImage}}" Width="18" Height="18" Margin="0,0,2,0"/>
                                    <TextBlock Text="{Binding Path=Dir.Name}" />
                                </StackPanel>
                            </HierarchicalDataTemplate>
                        </TreeView.Resources>
                        <TreeView.ContextMenu>
                            <ContextMenu>
                                <MenuItem Name="mItemEnableFolder" Header="{DynamicResource enablefolder}" Click="mItemEnableFolder_Click">
                                    <MenuItem.Icon>
                                        <Image Source="/ApfelmusFramework;component/Images/sharesubfolders.png" Width="18" Height="18"/>
                                    </MenuItem.Icon>
                                </MenuItem>
                                <MenuItem Name="mItemEnableFolder2" Header="{DynamicResource enablefolder2}" Click="mItemEnableFolder_Click_2">
                                    <MenuItem.Icon>
                                        <Image Source="/ApfelmusFramework;component/Images/sharefolder.png" Width="18" Height="18"/>
                                    </MenuItem.Icon>
                                </MenuItem>
                            </ContextMenu>
                        </TreeView.ContextMenu>
                    </TreeView>
                    <DataGrid Grid.Row="1" Grid.Column="1"  Width="Auto" VirtualizingPanel.IsVirtualizingWhenGrouping="True" VirtualizingPanel.VirtualizationMode="Recycling" AutoGenerateColumns="false" SelectionUnit="FullRow" CanUserAddRows="False" CanUserDeleteRows="False" Name="dGridShares" SelectionMode="Extended" GridLinesVisibility="None" ColumnWidth="auto" MouseRightButtonDown="dGridShares_MouseRightButtonDown" Margin="2,0,0,0" KeyDown="DGridShares_KeyDown" >
                        <!--<DataGrid Grid.Row="1" Grid.Column="1"  Width="Auto" AutoGenerateColumns="false" SelectionUnit="FullRow" CanUserAddRows="False" CanUserDeleteRows="False" Name="dGridShares" SelectionMode="Extended" GridLinesVisibility="None" ColumnWidth="auto" MouseRightButtonDown="dGridShares_MouseRightButtonDown" Margin="2,0,0,0">-->
                        <DataGrid.Resources>
                            <conv:FilenameToImage x:Key="FilenameToImage" />
                            <TextBlock x:Key="sharepath" Text="{DynamicResource path}" />
                            <TextBlock x:Key="sharen" Text="{DynamicResource sharename}" />
                            <TextBlock x:Key="shares" Text="{DynamicResource sharesize}" />
                            <TextBlock x:Key="sharep" Text="{DynamicResource sharepriority}" />
                            <TextBlock x:Key="lastr" Text="{DynamicResource lastrequest}" />
                            <TextBlock x:Key="downloadr" Text="{DynamicResource downloadrequest}" />
                            <TextBlock x:Key="searchr" Text="{DynamicResource searchrequest}" />
                            <Style x:Key="GroupHeaderStyle" TargetType="{x:Type GroupItem}">
                                <Setter Property="Template">
                                    <Setter.Value>
                                        <ControlTemplate TargetType="{x:Type GroupItem}">
                                            <Expander x:Name="exp" IsExpanded="True" Foreground="Black" Background="White">
                                                <Expander.Header>
                                                    <StackPanel Orientation="Horizontal">
                                                        <TextBlock Text="{Binding Name}" Margin="0 0 2 0" />
                                                        <TextBlock Text="{Binding ItemCount,Converter={StaticResource SetClip}}" />
                                                    </StackPanel>
                                                </Expander.Header>
                                                <ItemsPresenter />
                                            </Expander>
                                        </ControlTemplate>
                                    </Setter.Value>
                                </Setter>
                            </Style>
                        </DataGrid.Resources>
                        <DataGrid.GroupStyle>
                            <GroupStyle ContainerStyle="{StaticResource GroupHeaderStyle}">
                                <GroupStyle.Panel>
                                    <ItemsPanelTemplate>
                                        <DataGridRowsPresenter />
                                    </ItemsPanelTemplate>
                                </GroupStyle.Panel>
                            </GroupStyle>
                        </DataGrid.GroupStyle>
                        <DataGrid.ContextMenu>
                            <ContextMenu>
                                <MenuItem Name="mItemShareLink" Header="{DynamicResource copylink}" Click="ShareLink_Click" />
                                <MenuItem Name="mItemShareLinks" Header="{DynamicResource copylinks}" Click="ShareLinks_Click" />
                                <MenuItem Name="mitemShareSource" Header="{DynamicResource copysource}" Click="ShareSource_Click" />
                                <MenuItem Name="mitemShareSources" Header="{DynamicResource copysources}" Click="ShareSources_Click" />
                            </ContextMenu>
                        </DataGrid.ContextMenu>
                        <DataGrid.Columns>
                            <DataGridTemplateColumn Header="{StaticResource sharen}" Width="*" CanUserSort="True" SortMemberPath="ShortFileName">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <StackPanel Orientation="Horizontal">
                                            <Image Source="{Binding Path=ShortFileName,Converter={StaticResource FilenameToImage}}"/>
                                            <TextBlock Padding="2,0,2,0" Margin="0" Text="{Binding Path=ShortFileName}"/>
                                        </StackPanel>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                            <DataGridTextColumn Header="{StaticResource shares}" Width="80" Binding="{Binding Path=Size, Converter={StaticResource FileSizeConverter1}}" />
                            <DataGridTextColumn Header="{StaticResource sharep}" Width="100" Binding="{Binding Path=Priority}" />
                            <DataGridTextColumn Header="{StaticResource lastr}" Width="100" Binding="{Binding Path=LastAsked,Converter={StaticResource SecondsToDate}}" />
                            <DataGridTextColumn Header="{StaticResource downloadr}" Width="120" Binding="{Binding Path=AskCount}" />
                            <DataGridTextColumn Header="{StaticResource searchr}" Width="100" Binding="{Binding Path=SearchCount}" />
                        </DataGrid.Columns>
                    </DataGrid>
                    <GroupBox Grid.Column="1" Grid.Row="2" Header="{DynamicResource sharefolders}" Margin="5">
                        <StackPanel Name="sPanelShareFolders" Orientation="Vertical" VerticalAlignment="Center" HorizontalAlignment="Left" Margin="5"/>
                    </GroupBox>
                </Grid>
            </TabItem>
            <TabItem  Name="tabSearch">
                <TabItem.Header>
                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" VerticalAlignment="Center">
                        <Image Source="/ApfelmusFramework;component/Images/find.png" Width="18" Height="18" />
                        <TextBlock Text="{DynamicResource search}" Height="18" Margin="2,2,0,0" />
                    </StackPanel>
                </TabItem.Header>
                <Grid Margin="0,20,0,0">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="300"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    <Grid Grid.Column="0">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="200"/>
                            <RowDefinition Height="200"/>
                            <RowDefinition Height="200"/>
                        </Grid.RowDefinitions>
                        <StackPanel Grid.Row="0" Orientation="Vertical" Width="300">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="100" />
                                    <ColumnDefinition  Width="200"/>
                                </Grid.ColumnDefinitions>
                                <StackPanel Orientation="Vertical" Grid.Column="0">
                                    <Label Content="{DynamicResource searchstring}" />
                                </StackPanel>
                                <StackPanel Orientation="Vertical" Grid.Column="1" HorizontalAlignment="Center">
                                    <TextBox Name="tbxSearchContent" Width="195"  Margin="0,0,5,0"/>
                                    <Button Name="btnStartSearch" Width="195" Height="25" Content="{DynamicResource startsearch}" Margin="0,3,5,0" Click="btnStartSearch_Click" />
                                </StackPanel>
                            </Grid>
                        </StackPanel>
                        <StackPanel Grid.Row="1">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition />
                                    <ColumnDefinition />
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition />
                                    <RowDefinition />
                                    <RowDefinition />
                                </Grid.RowDefinitions>
                                <StackPanel Orientation="Vertical" Grid.Column="0" Grid.Row="0" Width="150" >
                                    <Label Name="lblFoundFiles" Content="{DynamicResource foundfiles}" />
                                    <Label Name="lblSumSearches" Content="{DynamicResource sumsearches}" />
                                </StackPanel>
                                <StackPanel Orientation="Vertical" Grid.Column="1" Grid.Row="0" Width="150">
                                    <Label Name="lblFoundFilesResult" Content="{Binding Path=FoundFiles}" />
                                    <Label Name="lblSumSearchesResult" Content="{Binding Path=SumSearches}" />
                                </StackPanel>
                                <StackPanel Grid.Row="1" Grid.ColumnSpan="2" Width="300" Orientation="Horizontal">
                                    <Label Name="lblStartSearch" Content="0" Width="50" Margin="10" />
                                    <ProgressBar Name="pBarSearch" Width="160" Height="10" Minimum="0" Maximum="{Binding Path=Users}" Value="{Binding Path=SumSearches}"/>
                                    <Label Name="lblEndSearch" Content="{Binding Path=Users}" Width="50" Margin="10"/>
                                </StackPanel>
                                <StackPanel Grid.Row="2" Grid.ColumnSpan="2" Width="300" Orientation="Horizontal">
                                    <Label Name="lblSearchStatus" Content="{DynamicResource searchstatus}" Width="50" Margin="10,10,0,10" />
                                    <ProgressBar Name="pBarSearchCount" Width="160" Height="10" Margin="10,10,60,10"/>
                                </StackPanel>
                            </Grid>
                        </StackPanel>
                    </Grid>
                    <TabControl Name="tControlSearches" Grid.Column="1" Margin="2,-14,0,14" MouseRightButtonDown="tControlSearches_MouseRightButtonDown">
                        <TabControl.Resources>
                            <conv:FileSizeConverter1 x:Key="FileSizeConverter" />
                            <conv:FilenameToImage x:Key="FilenameToImage" />
                            <conv:SearchColor x:Key="SearchColor" />
                        </TabControl.Resources>
                        <TabControl.ContextMenu>
                            <ContextMenu>
                                <MenuItem Name="mItemDownload" Header="{DynamicResource link}" Click="DownloadSearchResult_Click" />
                                <MenuItem Name="mItemSearchLink" Header="{DynamicResource copylink}" Click="SearchLink_Click" />
                                <MenuItem Name="mItemSearchSource" Header="{DynamicResource copysource}" Click="SearchSource_Click" />
                            </ContextMenu>
                        </TabControl.ContextMenu>

                    </TabControl>
                </Grid>
            </TabItem>
            <TabItem Name="tabDownload">
                <TabItem.Header>
                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" VerticalAlignment="Center">
                        <Image Source="/ApfelmusFramework;component/Images/arrow_down.png" Width="18" Height="18" />
                        <TextBlock Text="{DynamicResource downloads}" Height="18" Margin="2,2,0,0" />
                    </StackPanel>
                </TabItem.Header>
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="*" />
                        <RowDefinition Height="50" />
                        <RowDefinition Height="100" />
                    </Grid.RowDefinitions>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="220" />
                        <ColumnDefinition Width="*" />
                    </Grid.ColumnDefinitions>
                    <Grid Grid.Row="0" Grid.ColumnSpan="2" Grid.Column="0">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="*" />
                            <RowDefinition Height="5" />
                            <RowDefinition Height="*" />
                        </Grid.RowDefinitions>
                        <DataGrid Grid.Row="0" MinHeight="100" Height="Auto" MinWidth="870" Width="Auto" VirtualizingPanel.VirtualizationMode="Recycling" AutoGenerateColumns="False" Name="dGridDownloads" SelectionMode="Extended" SelectionUnit="FullRow" GridLinesVisibility="None" CanUserAddRows="False" CanUserDeleteRows="False" SelectionChanged="dGridDownloads_SelectionChanged" MouseRightButtonDown="dGridDownloads_MouseRightButtonDown" IsReadOnly="True" GotFocus="dGridDownloads_GotFocus" KeyDown="DGridDownloads_KeyDown">
                            <!--<DataGrid Grid.Row="0" MinHeight="100" Height="Auto" MinWidth="870" Width="Auto" AutoGenerateColumns="False" Name="dGridDownloads" SelectionMode="Extended" SelectionUnit="FullRow" GridLinesVisibility="None" CanUserAddRows="False" CanUserDeleteRows="False" SelectionChanged="dGridDownloads_SelectionChanged" MouseRightButtonDown="dGridDownloads_MouseRightButtonDown" IsReadOnly="True" GotFocus="dGridDownloads_GotFocus">-->
                            <DataGrid.ContextMenu>
                                <ContextMenu>
                                    <MenuItem Name="mItemContinue" Header="{DynamicResource continue}" Click="Continue_Click" />
                                    <MenuItem Name="mItemBreak" Header="{DynamicResource break}" Click="Break_Click" />
                                    <MenuItem Name="mItemCancel" Header="{DynamicResource cancel_download}" Click="Cancel_Click" />
                                    <MenuItem Name="mItemRename" Header="{DynamicResource rename}" Click="Rename_Click" />
                                    <MenuItem Name="mItemTarget" Header="{DynamicResource targetdir}" Click="TargetFolder_Click" />
                                    <MenuItem Name="mItemClean" Header="{DynamicResource finished}" Click="Finished_Click" />
                                    <MenuItem Name="mItemLink" Header="{DynamicResource copylink}" Click="Link_Click" />
                                    <MenuItem Name="mItemSource" Header="{DynamicResource copysource}" Click="Source_Click" />
                                </ContextMenu>
                            </DataGrid.ContextMenu>
                            <DataGrid.Resources>
                                <conv:FileSizeConverter1 x:Key="FileSizeConverter1" />
                                <conv:FileSizeConverter4 x:Key="FileSizeConverter4" />
                                <conv:DownloadsColor x:Key="DownloadsColor" />
                                <conv:PowerDownload x:Key="PowerDownload" />
                                <conv:Time x:Key="Time" />
                                <conv:SetDownloadStatus x:Key="SetDownloadStatus" />
                                <conv:FilenameToImage x:Key="FilenameToImage" />
                                <TextBlock x:Key="filename_d" Text="{DynamicResource filename_download}" />
                                <TextBlock x:Key="status_d" Text="{DynamicResource status_download}" />
                                <TextBlock x:Key="download_n" Text="{DynamicResource download_nick}" />
                                <TextBlock x:Key="current_d" Text="{DynamicResource current_download_size}" />
                                <TextBlock x:Key="download_sp" Text="{DynamicResource download_speed}" />
                                <TextBlock x:Key="download_s" Text="{DynamicResource download_size}" />
                                <TextBlock x:Key="download_t" Text="{DynamicResource download_time}" />
                                <TextBlock x:Key="download_p" Text="{DynamicResource download_percentages}" />
                                <TextBlock x:Key="download_r" Text="{DynamicResource download_rest}" />
                                <TextBlock x:Key="powerdown" Text="{DynamicResource powerdownload}" />
                                <TextBlock x:Key="download_c" Text="{DynamicResource download_core}" />
                            </DataGrid.Resources>
                            <DataGrid.RowStyle>
                                <Style TargetType="{x:Type DataGridRow}">
                                    <Setter Property="Background" Value="{Binding Path=Status, Converter={StaticResource DownloadsColor}}" />
                                </Style>
                            </DataGrid.RowStyle>
                            <DataGrid.Columns>
                                <DataGridTemplateColumn Header="{StaticResource filename_d}" Width="*" CanUserSort="True" SortMemberPath="FileName">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <StackPanel Orientation="Horizontal">
                                                <Image Source="{Binding Path=FileName,Converter={StaticResource FilenameToImage}}"/>
                                                <TextBlock Padding="2,0,2,0" Margin="0" Text="{Binding Path=FileName}"/>
                                            </StackPanel>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                                <DataGridTextColumn Header="{StaticResource status_d}">
                                    <DataGridTextColumn.Binding>
                                        <MultiBinding Converter="{StaticResource SetDownloadStatus}">
                                            <Binding Path="Status" />
                                            <Binding Path="DownloadUsers" />
                                            <Binding Path="AllUsers" />
                                            <Binding Path="ActiveUsers" />
                                        </MultiBinding>
                                    </DataGridTextColumn.Binding>
                                </DataGridTextColumn>
                                <DataGridTextColumn Header="{StaticResource download_s}" Binding="{Binding Path=Size, Converter={StaticResource FileSizeConverter1}}" />
                                <DataGridTextColumn Header="{StaticResource current_d}" Binding="{Binding Path=DownloadedFilesize, Converter={StaticResource FileSizeConverter1}}" />
                                <DataGridTextColumn Header="{StaticResource download_sp}" Binding="{Binding Path=Speed, Converter={StaticResource FileSizeConverter4}}" />
                                <DataGridTextColumn Header="{StaticResource download_t}" Binding="{Binding Path=TimeToEnd,Converter={StaticResource Time}}" />
                                <DataGridTemplateColumn Header="{StaticResource download_p}">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <ProgressBar Style="{DynamicResource ResourceKey=ProgressBarWithText}" Name="pBarDownloads" Foreground="Blue" FontWeight="Bold" Minimum="0" Maximum="{Binding Path=Size}"  Value="{Binding Path=CheckIfIsOver, Mode=OneWay}" Tag="{Binding Path=Percentages}" Width="100" Height="16"/>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                                <DataGridTextColumn Header="{StaticResource download_r}" Binding="{Binding Path=DownloadRest, Converter={StaticResource FileSizeConverter1}}" />
                                <DataGridTextColumn Header="{StaticResource powerdown}" Binding="{Binding Path=PowerDownload, Converter={StaticResource PowerDownload}}" />
                            </DataGrid.Columns>
                        </DataGrid>
                        <DataGrid Grid.Row="2" MinHeight="100" Height="Auto" MinWidth="870" Width="Auto" VirtualizingPanel.VirtualizationMode="Recycling" AutoGenerateColumns="False" Name="dGridDownloadInfos" SelectionMode="Single" SelectionUnit="FullRow" GridLinesVisibility="None" CanUserAddRows="False" CanUserDeleteRows="False" IsReadOnly="True" SelectionChanged="dGridDownloadInfos_SelectionChanged_1">
                            <!--<DataGrid Grid.Row="2" MinHeight="100" Height="Auto" MinWidth="870" Width="Auto" AutoGenerateColumns="False" Name="dGridDownloadInfos" SelectionMode="Single" SelectionUnit="FullRow" GridLinesVisibility="None" CanUserAddRows="False" CanUserDeleteRows="False" IsReadOnly="True" SelectionChanged="dGridDownloadInfos_SelectionChanged_1">-->
                            <DataGrid.Resources>
                                <conv:UserStatus x:Key="UserStatus" />
                                <conv:FileSizeConverter1 x:Key="FileSizeConverter1" />
                                <conv:FileSizeConverter2 x:Key="FileSizeConverter2" />
                                <conv:FileSizeConverter3 x:Key="FileSizeConverter3" />
                                <conv:FileSizeConverter4 x:Key="FileSizeConverter4" />
                                <conv:PowerDownload x:Key="PowerDownload" />
                                <conv:Time x:Key="Time" />
                                <conv:FilenameToImage x:Key="FilenameToImage" />
                                <TextBlock x:Key="filename_d" Text="{DynamicResource filename_download}" />
                                <TextBlock x:Key="status_d" Text="{DynamicResource status_download}" />
                                <TextBlock x:Key="download_n" Text="{DynamicResource download_nick}" />
                                <TextBlock x:Key="current_d" Text="{DynamicResource current_download_size}" />
                                <TextBlock x:Key="download_sp" Text="{DynamicResource download_speed}" />
                                <TextBlock x:Key="download_s" Text="{DynamicResource download_size}" />
                                <TextBlock x:Key="download_t" Text="{DynamicResource download_time}" />
                                <TextBlock x:Key="download_p" Text="{DynamicResource download_percentages}" />
                                <TextBlock x:Key="download_r" Text="{DynamicResource download_rest}" />
                                <TextBlock x:Key="powerdown" Text="{DynamicResource powerdownload}" />
                                <TextBlock x:Key="download_c" Text="{DynamicResource download_core}" />
                            </DataGrid.Resources>
                            <DataGrid.Columns>
                                <DataGridTemplateColumn Header="{StaticResource filename_d}" Width="*" CanUserSort="True" SortMemberPath="FileName">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <StackPanel Orientation="Horizontal">
                                                <Image Source="{Binding Path=FileName,Converter={StaticResource FilenameToImage}}" Width="16" Height="16"/>
                                                <TextBlock Padding="2,0,2,0" Margin="0" Text="{Binding Path=FileName}"/>
                                            </StackPanel>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                                <DataGridTextColumn Header="{StaticResource status_d}" Binding="{Binding Path=Status, Converter={StaticResource UserStatus}}" />
                                <DataGridTextColumn Header="{StaticResource download_n}" Binding="{Binding Path=NickName}" />
                                <DataGridTextColumn Header="{StaticResource download_s}" Binding="{Binding Path=FileSize, Converter={StaticResource FileSizeConverter1}}" />
                                <DataGridTextColumn Header="{StaticResource current_d}" Binding="{Binding Path=ActualFileSize, Converter={StaticResource FileSizeConverter1}}" />
                                <DataGridTextColumn Header="{StaticResource download_sp}" Binding="{Binding Path=Speed, Converter={StaticResource FileSizeConverter4}}" />
                                <DataGridTextColumn Header="{StaticResource download_t}" Binding="{Binding Path=TimeToEnd,Converter={StaticResource Time}}" />
                                <DataGridTemplateColumn Header="{StaticResource download_p}">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <ProgressBar Style="{DynamicResource ResourceKey=ProgressBarWithText}" Name="pBarDownloadsUser" Foreground="Blue" FontWeight="Bold" Minimum="{Binding Path=DownloadFrom}" Maximum="{Binding Path=DownloadTo}"  Value="{Binding Path=ActualDownloadPosition}" Tag="{Binding Path=Percentages}" Width="100" Height="16"/>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                                <DataGridTextColumn Header="{StaticResource download_r}" Binding="{Binding Path=FileSizeToGet, Converter={StaticResource FileSizeConverter1}}" />
                                <DataGridTextColumn Header="{StaticResource powerdown}" Binding="{Binding Path=PowerDownload, Converter={StaticResource PowerDownload}}" />
                                <DataGridTemplateColumn Header="{StaticResource download_c}">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <StackPanel Orientation="Horizontal">
                                                <Image Source="{Binding Path=OS, Mode=OneWay}" Width="16" Height="16"/>
                                                <Label Padding="2,0,2,0" Margin="0" Content="{Binding Path=Version, Mode=OneWay}"/>
                                            </StackPanel>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                            </DataGrid.Columns>
                        </DataGrid>
                        <GridSplitter ShowsPreview="True" Grid.Row="1" HorizontalAlignment="Stretch" Height="3" Margin="0,1" />

                    </Grid>
                    <GroupBox Grid.Row="1" Height="50" Header="User status" Width="200" HorizontalAlignment="Left">
                        <StackPanel Orientation="Horizontal" VerticalAlignment="Center" HorizontalAlignment="Center">
                            <RadioButton Name="rBtnActive" Content="Active" GroupName="User" Margin="5" IsChecked="True" Checked="rBtnActive_Checked" />
                            <RadioButton Name="rBtnWait" Content="Queue" GroupName="User" Margin="5" Checked="rBtnWait_Checked" />
                            <RadioButton Name="rBtnRest" Content="Rest" GroupName="User" Margin="5" Checked="rBtnRest_Checked" />
                        </StackPanel>
                    </GroupBox>
                    <GroupBox Grid.Row="2" Grid.Column="0" Width="213" Height="100" HorizontalAlignment="Left" VerticalAlignment="Top" Header="Powerdownload" Grid.ColumnSpan="2">
                        <DockPanel LastChildFill="False">
                            <TextBlock  DockPanel.Dock="Top" TextWrapping="Wrap" Padding="5"  Text="{DynamicResource powerdownload_text}" />
                            <StackPanel DockPanel.Dock="Top" Orientation="Horizontal" Margin="5">
                                <ComboBox Name="cbxPowerDownload" Width="50" ItemsSource="{Binding Path=PowerValues}" DisplayMemberPath="Value" SelectedValuePath="Key" SelectedValue="0"/>
                                <Button Name="btnPowerDownload" Content="{DynamicResource apply}" Width="100" Margin="40,0,0,0" Click="btnPowerDownload_Click" />
                            </StackPanel>
                        </DockPanel>
                    </GroupBox>
                    <StackPanel Orientation="Horizontal" Grid.Row="1" Grid.Column="1" VerticalAlignment="Top" HorizontalAlignment="Left">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition />
                                <ColumnDefinition />
                                <ColumnDefinition />
                                <ColumnDefinition />
                                <ColumnDefinition />
                                <ColumnDefinition />
                                <ColumnDefinition />
                            </Grid.ColumnDefinitions>
                            <Label Grid.Column="0" Content="{DynamicResource partlist}" />
                            <CheckBox Grid.Column="1" Name="cBoxPartList" Checked="cBoxPartList_Checked" Unchecked="cBoxPartList_Unchecked" Margin="8" />
                            <StackPanel Orientation="Horizontal" Grid.Column="2" Margin="20,0,0,0">
                                <Label Content="{DynamicResource colorunavailable}" />
                                <Rectangle Fill="Red" Width="6" Height="8" />
                                <Rectangle Fill="Red" Width="6" Height="8"/>
                                <Rectangle Fill="Red" Width="6" Height="8" />
                            </StackPanel>
                            <StackPanel Orientation="Horizontal" Grid.Column="3" Margin="20,0,0,0">
                                <Label Content="{DynamicResource coloravailable}" />
                                <Rectangle Fill="LightBlue" Width="6" Height="8" />
                                <Rectangle Fill="Blue" Width="6" Height="8"/>
                                <Rectangle Fill="DarkBlue" Width="6" Height="8" />
                            </StackPanel>
                            <StackPanel Orientation="Horizontal" Grid.Column="4" Margin="20,0,0,0">
                                <Label Content="{DynamicResource coloractive}" />
                                <Rectangle Fill="Yellow" Width="6" Height="8" />
                                <Rectangle Fill="Yellow" Width="6" Height="8"/>
                                <Rectangle Fill="Yellow" Width="6" Height="8" />
                            </StackPanel>
                            <StackPanel Orientation="Horizontal" Grid.Column="5" Margin="20,0,0,0">
                                <Label Content="{DynamicResource colorloaded}" />
                                <Rectangle Fill="Orange" Width="6" Height="8" />
                                <Rectangle Fill="Orange" Width="6" Height="8"/>
                                <Rectangle Fill="Orange" Width="6" Height="8" />
                            </StackPanel>
                            <StackPanel Orientation="Horizontal" Grid.Column="6" Margin="20,0,0,0">
                                <Label Content="{DynamicResource colorfinished}"/>
                                <Rectangle Fill="Green" Width="6" Height="8" />
                                <Rectangle Fill="Green" Width="6" Height="8"/>
                                <Rectangle Fill="Green" Width="6" Height="8" />
                            </StackPanel>
                        </Grid>
                    </StackPanel>
                    <WrapPanel Name="wPanelPartList" Grid.Row="1" Grid.RowSpan="2" Grid.Column="1" Width="744" Height="120" VerticalAlignment="Bottom" />
                </Grid>
            </TabItem>
            <TabItem Name="tabUpload">
                <TabItem.Header>
                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" VerticalAlignment="Center">
                        <Image Source="/ApfelmusFramework;component/Images/arrow_up.png" Width="18" Height="18" />
                        <TextBlock Text="{DynamicResource uploads}" Height="18" Margin="2,2,0,0" />
                    </StackPanel>
                </TabItem.Header>
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="*"></RowDefinition>
                        <RowDefinition Height="5"></RowDefinition>
                        <RowDefinition Height="*"></RowDefinition>
                    </Grid.RowDefinitions>
                    <DataGrid Grid.Row="0" MinHeight="100" Height="Auto" MinWidth="870" Width="Auto" VirtualizingPanel.VirtualizationMode="Recycling"  AutoGenerateColumns="False" Name="dGridUploads" SelectionMode="Single" SelectionUnit="FullRow" GridLinesVisibility="None" CanUserAddRows="False" CanUserDeleteRows="False" >
                        <!--<DataGrid Grid.Row="0" MinHeight="100" Height="Auto" MinWidth="870" Width="Auto" AutoGenerateColumns="False" Name="dGridUploads" SelectionMode="Single" SelectionUnit="FullRow" GridLinesVisibility="None" CanUserAddRows="False" CanUserDeleteRows="False" >-->
                        <DataGrid.Resources>
                            <conv:FileSizeConverter1 x:Key="FileSizeConverter1" />
                            <conv:FileSizeConverter4 x:Key="FileSizeConverter4" />
                            <conv:FilenameToImage x:Key="FilenameToImage" />
                            <TextBlock x:Key="filename_u" Text="{DynamicResource filename_upload}" />
                            <TextBlock x:Key="upload_n" Text="{DynamicResource upload_nick}" />
                            <TextBlock x:Key="upload_sp" Text="{DynamicResource upload_speed}" />
                            <TextBlock x:Key="upload_p" Text="{DynamicResource upload_percentages}" />
                            <TextBlock x:Key="water" Text="{DynamicResource waterlevel}" />
                            <TextBlock x:Key="upload_pr" Text="{DynamicResource upload_priority}" />
                            <TextBlock x:Key="upload_c" Text="{DynamicResource upload_core}" />
                        </DataGrid.Resources>
                        <DataGrid.Columns>
                            <DataGridTemplateColumn Header="{StaticResource filename_u}" Width="*" CanUserSort="True" SortMemberPath="FileName">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <StackPanel Orientation="Horizontal">
                                            <Image Source="{Binding Path=FileName,Converter={StaticResource FilenameToImage}}"/>
                                            <TextBlock Padding="2,0,2,0" Margin="0" Text="{Binding Path=FileName}"/>
                                        </StackPanel>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                            <DataGridTextColumn Header="{StaticResource upload_n}" Width="100" Binding="{Binding Path=Nick, Mode=OneWay}" />
                            <DataGridTextColumn Header="{StaticResource upload_sp}" Width="100" Binding="{Binding Path=Speed, Converter={StaticResource FileSizeConverter4}, Mode=OneWay}" />
                            <DataGridTemplateColumn Header="{StaticResource upload_p}" Width="100">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <ProgressBar Style="{DynamicResource ResourceKey=ProgressBarWithText}"  Name="pBarDownloads" Foreground="Blue" FontWeight="Bold" Minimum="{Binding Path=UploadFrom, Mode=OneWay}" Maximum="{Binding Path=UploadTo, Mode=OneWay}"  Value="{Binding Path=ActualUploadPosition, Mode=OneWay}" Tag="{Binding Path=Percentages}" Width="100" Height="16"/>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                            <DataGridTemplateColumn Header="{StaticResource water}" Width="100">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <ProgressBar Style="{DynamicResource ResourceKey=ProgressBarWithText}" Width="100" Name="pBarDownloads" Foreground="Blue" FontWeight="Bold" Minimum="0" Maximum="1"  Value="{Binding Path=Loaded, Mode=OneWay}" Tag="{Binding Path=WPercentages}" Height="16"/>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                            <DataGridTextColumn Header="{StaticResource upload_pr}" Width="100" Binding="{Binding Path=Priority, Mode=OneWay}" />
                            <DataGridTemplateColumn Header="{StaticResource upload_c}" Width="100">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <StackPanel Orientation="Horizontal">
                                            <Image Source="{Binding Path=OS, Mode=OneWay}"/>
                                            <TextBlock Padding="2,0,2,0" Margin="0" Text="{Binding Path=Version, Mode=OneWay}"/>
                                        </StackPanel>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                        </DataGrid.Columns>
                    </DataGrid>
                    <DataGrid Grid.Row="2" MinHeight="100" Height="Auto" MinWidth="870" Width="Auto" AutoGenerateColumns="False" Name="dGridUploadInfos" SelectionMode="Single" SelectionUnit="FullRow" GridLinesVisibility="None" CanUserAddRows="False" CanUserDeleteRows="False" VirtualizingPanel.VirtualizationMode="Recycling">
                        <!--<DataGrid Grid.Row="2" MinHeight="100" Height="Auto" MinWidth="870" Width="Auto" AutoGenerateColumns="False" Name="dGridUploadInfos" SelectionMode="Single" SelectionUnit="FullRow" GridLinesVisibility="None" CanUserAddRows="False" CanUserDeleteRows="False">-->
                        <DataGrid.Resources>
                            <conv:SecondsToDate x:Key="SecondsToDate" />
                            <conv:SetUploadStatus x:Key="SetUploadStatus" />
                            <conv:FilenameToImage x:Key="FilenameToImage" />
                            <TextBlock x:Key="filename_u" Text="{DynamicResource filename_upload}" />
                            <TextBlock x:Key="upload_n" Text="{DynamicResource upload_nick}" />
                            <TextBlock x:Key="upload_st" Text="{DynamicResource upload_status}" />
                            <TextBlock x:Key="upload_p" Text="{DynamicResource upload_percentages}" />
                            <TextBlock x:Key="water" Text="{DynamicResource waterlevel}" />
                            <TextBlock x:Key="upload_pr" Text="{DynamicResource upload_priority}" />
                            <TextBlock x:Key="upload_c" Text="{DynamicResource upload_core}" />
                            <TextBlock x:Key="last" Text="{DynamicResource lastseen}" />
                        </DataGrid.Resources>
                        <DataGrid.Columns>
                            <DataGridTemplateColumn Header="{StaticResource filename_u}" Width="*" CanUserSort="True" SortMemberPath="FileName">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <StackPanel Orientation="Horizontal">
                                            <Image Source="{Binding Path=FileName,Converter={StaticResource FilenameToImage}}"/>
                                            <TextBlock Padding="2,0,2,0" Margin="0" Text="{Binding Path=FileName}"/>
                                        </StackPanel>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                            <DataGridTextColumn Header="{StaticResource upload_st}" Width="100" Binding="{Binding Path=Status, Mode=OneWay, Converter={StaticResource SetUploadStatus}}" />
                            <DataGridTextColumn Header="{StaticResource upload_n}" Width="100" Binding="{Binding Path=Nick, Mode=OneWay}" />
                            <DataGridTemplateColumn Header="{StaticResource water}" Width="100">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <ProgressBar Style="{DynamicResource ResourceKey=ProgressBarWithText}" Name="pBarDownloadsUser" Foreground="Blue" FontWeight="Bold" Minimum="0" Maximum="1"  Value="{Binding Path=Loaded, Mode=OneWay}" Tag="{Binding Path=WPercentages}" Width="100" Height="16"/>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                            <DataGridTextColumn Header="{StaticResource upload_pr}" Binding="{Binding Path=Priority, Mode=OneWay}" Width="100" />
                            <DataGridTextColumn Header="{StaticResource last}" Binding="{Binding Path=LastConnection, Mode=OneWay, Converter={StaticResource SecondsToDate}}" Width="100" />
                            <DataGridTemplateColumn Header="{StaticResource upload_c}" Width="100">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <StackPanel Orientation="Horizontal">
                                            <Image Source="{Binding Path=OS, Mode=OneWay}" />
                                            <TextBlock Padding="2,0,2,0" Margin="0" Text="{Binding Path=Version, Mode=OneWay}" />
                                        </StackPanel>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                        </DataGrid.Columns>
                    </DataGrid>
                    <GridSplitter ShowsPreview="True" Grid.Row="1" HorizontalAlignment="Stretch" Height="3" Margin="0,1" />
                </Grid>
            </TabItem>
            <TabItem Name="tabServer">
                <TabItem.Header>
                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" VerticalAlignment="Center">
                        <Image Source="/ApfelmusFramework;component/Images/file_server.png" Width="18" Height="18" />
                        <TextBlock Text="{DynamicResource server}" Height="18" Margin="2,2,0,0" />
                    </StackPanel>
                </TabItem.Header>
                <DockPanel >
                    <DockPanel.Resources>
                        <conv:SecondsToDate x:Key="SecondsToDate" />
                    </DockPanel.Resources>
                    <DataGrid AutoGenerateColumns="False" VirtualizingPanel.VirtualizationMode="Recycling" Name="dGridServer" GridLinesVisibility="None" CanUserAddRows="False" CanUserDeleteRows="False" SelectionMode="Single" MouseRightButtonDown="dGridServer_MouseRightButtonDown">
                        <!--<DataGrid AutoGenerateColumns="False" Name="dGridServer" GridLinesVisibility="None" CanUserAddRows="False" CanUserDeleteRows="False" SelectionMode="Single" MouseRightButtonDown="dGridServer_MouseRightButtonDown">-->
                        <DataGrid.ContextMenu>
                            <ContextMenu>
                                <MenuItem Name="mItemConnectServer" Header="{DynamicResource connectserver}" Click="ConnectServer_Click" />
                                <MenuItem Name="mitemGetServer" Header="{DynamicResource addserver}" Click="GetServer_Click" />
                                <MenuItem Name="mItemCopyLink" Header="{DynamicResource copyserverlink}" Click="mItemCopyLink_Click" />
                                <MenuItem Name="mItemDeleteServer" Header="{DynamicResource delete}" Click="RemoveServer_Click" />
                            </ContextMenu>
                        </DataGrid.ContextMenu>
                        <DataGrid.Resources>
                            <conv:ServerColor x:Key="ServerColor" />
                            <TextBlock x:Key="servern" Text="{DynamicResource servername}" />
                            <TextBlock x:Key="serverh" Text="{DynamicResource serverhostname}" />
                            <TextBlock x:Key="serverp" Text="{DynamicResource serverport}" />
                            <TextBlock x:Key="last" Text="{DynamicResource lastseen}" />
                            <TextBlock x:Key="connect" Text="{DynamicResource connections}" />
                        </DataGrid.Resources>
                        <DataGrid.RowStyle>
                            <Style TargetType="{x:Type DataGridRow}">
                                <Setter Property="Background" Value="{Binding Path=IsConnected, Converter={StaticResource ServerColor}}" />
                            </Style>
                        </DataGrid.RowStyle>
                        <DataGrid.Columns>
                            <DataGridTemplateColumn Header="{StaticResource servern}" CanUserSort="True" SortMemberPath="Name" Width="*">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <StackPanel Orientation="Horizontal">
                                            <Image Source="/ApfelmusFramework;component/Images/Home_Server.png" Margin="0,0,2,0" Width="18" Height="18"/>
                                            <TextBlock Text="{Binding Path=Name}" />
                                        </StackPanel>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                            <DataGridTextColumn Header="{StaticResource serverh}" Binding="{Binding Path=Host, Mode=OneWay}" Width="*"/>
                            <DataGridTextColumn Header="{StaticResource serverp}" Binding="{Binding Path=Port, Mode=OneWay}" Width="100"/>
                            <DataGridTextColumn Header="{StaticResource last}" Binding="{Binding Path=LastSeen, Mode=OneWay,  Converter={StaticResource SecondsToDate}}" Width="100"/>
                            <DataGridTextColumn Header="{StaticResource connect}" Binding="{Binding Path=ConnectionTry, Mode=OneWay}" Width="100"/>
                        </DataGrid.Columns>
                    </DataGrid>
                </DockPanel>
            </TabItem>
        </TabControl>
        <StatusBar Grid.Row="3" Height="25" FlowDirection="RightToLeft">
            <StatusBar.Resources>
                <conv:FileSizeConverter1 x:Key="FileSizeConverter1" />
                <conv:FileSizeConverter4 x:Key="FileSizeConverter4" />
                <conv:CreditsColor x:Key="CreditsColor" />
            </StatusBar.Resources>
            <StatusBarItem Margin="5,0,0,0">
                <Label Name="lblCreditsValue" Content="{Binding Path=Credits, Converter={StaticResource FileSizeConverter1}}" Foreground="{Binding Path=Credits, Converter={StaticResource CreditsColor}}" Padding="1,0,1,0" VerticalAlignment="Center" HorizontalAlignment="Center" FlowDirection="LeftToRight"/>
            </StatusBarItem>
            <StatusBarItem>
                <Label Name="lblCredits" Content="Credits:" Padding="1,0,1,0" VerticalAlignment="Center" HorizontalAlignment="Center" FlowDirection="LeftToRight"/>
            </StatusBarItem>
            <Separator />
            <StatusBarItem>
                <Label Name="lblUploadsValue" Content="{Binding Path=UploadSpeed, Converter={StaticResource FileSizeConverter4}}" Padding="1,0,1,0" VerticalAlignment="Center" HorizontalAlignment="Center" FlowDirection="LeftToRight"/>
            </StatusBarItem>
            <StatusBarItem>
                <Label Name="lblUploads" Content="Upload:" Padding="1,0,1,0" VerticalAlignment="Center" HorizontalAlignment="Center" FlowDirection="LeftToRight"/>
            </StatusBarItem>
            <Separator />
            <StatusBarItem>
                <Label Name="lblDownloadsValue" Content="{Binding Path=DownloadSpeed, Converter={StaticResource FileSizeConverter4}}" VerticalAlignment="Center" HorizontalAlignment="Center" Margin="0" Padding="1,0,1,0" FlowDirection="LeftToRight"/>
            </StatusBarItem>
            <StatusBarItem>
                <Label Name="lblDownloads" Content="Download: " Margin="0" Padding="1,0,1,0" VerticalAlignment="Center" HorizontalAlignment="Center" FlowDirection="LeftToRight"/>
            </StatusBarItem>
            <Separator />
            <StatusBarItem>
                <Label Name="lblTrafficOut" Content="out" Margin="0" Padding="1,0,1,0" VerticalAlignment="Center" HorizontalAlignment="Center" FlowDirection="LeftToRight"/>
            </StatusBarItem>
            <StatusBarItem>
                <Label Name="lblTrafficOutValue" Content="{Binding  Path=SessionUpload, Converter={StaticResource FileSizeConverter1}}" VerticalAlignment="Center" HorizontalAlignment="Center" Margin="0" Padding="1,0,1,0" FlowDirection="LeftToRight"/>
            </StatusBarItem>
            <StatusBarItem>
                <Label Name="lblTrafficIn" Content="in," Margin="0" Padding="1,0,1,0" VerticalAlignment="Center" HorizontalAlignment="Center" FlowDirection="LeftToRight"/>
            </StatusBarItem>
            <StatusBarItem>
                <Label Name="lblTrafficInValue" Content="{Binding  Path=SessionDownload, Converter={StaticResource FileSizeConverter1}}" VerticalAlignment="Center" HorizontalAlignment="Center" Margin="0" Padding="1,0,1,0" FlowDirection="LeftToRight"/>
            </StatusBarItem>
            <StatusBarItem>
                <Label Name="lblTraffic" Content="Traffic:" Margin="0" Padding="1,0,1,0" VerticalAlignment="Center" HorizontalAlignment="Center" FlowDirection="LeftToRight"/>
            </StatusBarItem>
            <Separator HorizontalAlignment="Left"/>
        </StatusBar>
    </Grid>
</Window>